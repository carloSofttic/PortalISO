<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}">
    <link rel="preconnect" href="https://js.stripe.com" crossorigin>
    <link rel="dns-prefetch" href="https://js.stripe.com">


    <title>Confirmar pago — Plataforma ISO</title>

    <!-- Estilos -->
    <link rel="stylesheet" th:href="@{/css/payment.css}" href="/css/payment.css" />

    <!-- Claves/plan -->
    <meta name="stripe-public-key" th:content="${stripePublicKey}" content="" />
    <meta name="plan-key" th:content="${planKey}" content="" />

    <!-- Stripe -->
    <script src="https://js.stripe.com/v3"></script>
    <script defer th:src="@{/js/checkout.js}" src="/js/checkout.js"></script>
</head>

<body class="pay-body">

    <div class="pay-wrap">
        <h1 class="pay-title">Confirmar pago</h1>
        <p class="pay-subtitle">Revisa tu plan y completa tus datos para realizar el pago de forma segura.</p>

        <div class="pay-grid">
            <!-- Resumen plan -->
            <section class="panel plan">
                <div class="plan-head">
                    <span class="badge" th:text="${planKey}" id="plan-badge">MONTHLY</span>
                    <a class="link-inline" href="/memberships">Cambiar plan</a>
                </div>

                <h2 class="plan-name" th:text="${plan != null} ? ${plan.nombre} : 'Plan'">Plan Mensual</h2>

                <div class="price-row">
                    <span class="currency" th:text="${plan != null} ? ${plan.moneda} : 'MXN'">MXN</span>
                    <span class="price" th:text="${plan != null} ? ${plan.precio} : '0.00'">499.00</span>
                    <span class="period" th:text="${plan != null} ? ${plan.descripcion} : ''">Acceso mensual</span>
                </div>

                <ul class="bullets">
                    <li>Acceso completo al sistema</li>
                    <li>Actualizaciones automáticas</li>
                    <li>Soporte por email</li>
                </ul>

                <div class="secure">
                    <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill="currentColor"
                            d="M12 1a5 5 0 00-5 5v3H6a2 2 0 00-2 2v7a2 2 0 002 2h12a2 2 0 002-2v-7a2 2 0 00-2-2h-1V6a5 5 0 00-5-5zm-3 8V6a3 3 0 016 0v3H9z" />
                    </svg>
                    Pagos seguros procesados por Stripe.
                </div>

                <div class="hint">
                    Para pruebas usa <strong>4242 4242 4242 4242</strong>, cualquier fecha futura y CVC.
                </div>
            </section>


            <!-- Formulario pago -->
            <section class="panel pay-card">
                <h2 class="plan-name">Formulario de pago</h2>
                <!-- Tarjeta -->
                <div class="field">
                    <label>Tarjeta</label>
                    <div id="card-element" class="element-box"></div>
                    <div id="card-errors" class="msg" role="alert" aria-live="polite"></div>
                </div>

                <div class="form-row two">
                    <div class="field">
                        <label for="cardholder-name">Nombre del titular</label>
                        <input id="cardholder-name" type="text" placeholder="Nombre como aparece en la tarjeta"
                            autocomplete="cc-name" />
                    </div>
                    <div class="field">
                        <label for="cardholder-email">Correo electrónico</label>
                        <input id="cardholder-email" type="email" placeholder="tucorreo@empresa.com"
                            autocomplete="email" />
                    </div>
                </div>

                <!-- Dirección de facturación -->

                <div class="fieldset">
                    <div class="form-row two">
                        <div class="field">
                            <label for="billing-line1">Dirección (línea 1)</label>
                            <input id="billing-line1" type="text" placeholder="Calle y número"
                                autocomplete="address-line1" />
                        </div>
                        <div class="field">
                            <label for="billing-line2">Dirección (línea 2) <span class="muted">(opcional)</span></label>
                            <input id="billing-line2" type="text" placeholder="Depto., interior, referencias"
                                autocomplete="address-line2" />
                        </div>
                    </div>

                    <div class="form-row address-geo">
                        <div class="field">
                            <label for="billing-city">Ciudad</label>
                            <input id="billing-city" type="text" placeholder="Ciudad" autocomplete="address-level2" />
                        </div>
                        <div class="field">
                            <label for="billing-state">Estado/Provincia</label>
                            <input id="billing-state" type="text" placeholder="Estado" autocomplete="address-level1" />
                        </div>
                        <div class="field">
                            <label for="billing-postal">Código postal</label>
                            <input id="billing-postal" type="text" placeholder="01234" autocomplete="postal-code" />
                        </div>
                    </div>

                    <div class="form-row one">
                        <div class="field">
                            <label for="billing-country">País</label>
                            <select id="billing-country" autocomplete="country">
                                <option value="MX" selected>México (MX)</option>
                                <option value="US">Estados Unidos (US)</option>
                                <option value="CA">Canadá (CA)</option>
                                <option value="ES">España (ES)</option>
                                <option value="AR">Argentina (AR)</option>
                                <option value="CO">Colombia (CO)</option>
                                <option value="CL">Chile (CL)</option>
                                <option value="">Otro</option>
                            </select>
                        </div>
                    </div>
                </div>



                <div class="actions-row">
                    <button id="payBtn" class="btn" type="button">
                        <span class="btn-label">Pagar ahora</span>
                        <span class="spinner" aria-hidden="true"></span>
                    </button>
                    <a class="btn-secondary" href="/memberships">Cambiar plan</a>
                </div>
            </section>
        </div>
    </div>

</body>

</html>